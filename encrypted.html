<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="template_toggle_show"
                                title="template_toggle_show"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = 
            ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        ;
            const templateError = "template_error",
                templateToggleAltShow = "template_toggle_show",
                templateToggleAltHide = "template_toggle_hide",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"9ed4deabc202b6bb76aac2621fea70070b6aef9e1a87aba147ac1e4a237c8af05f243f24f4a2ae9d696672e2bacac6397b04bd4c1f02c6378b05fb241e1a0956a9814d79e48136bba7c31abe7b053e7121644fe252ed8728bc9c29a6e012c98ab2efe95b52e3ca94f3663950f4bd4f9546f4313c6d979bbba91a2d54a3d7a812ae323ab2508f2fc6e6a7134da14ebf8652f62c37a36a92764a7c353b71dfbe572456fd11fe133d2d119605be374b793504488455bcb0c66dbe6d9b41a376b54f04dbf5fcc0b114576788984faec89834c6826eb65c40d73bcf0c0fff9916b15c486154b14cd2701a7e2c825b43059fd5f7f4c37d463f7c3a6a03fb84e23bbd4d22cd4b8b176f3d41c5cc6253f6788832c1cce4eb690b0d87bed237678925ffb24e745e98da33fa3ba4ec923b1894e979f1addc864bc3a2d5115f545c67ccf39fd43a677500d970ab117cd26102f0b45746c193e4af41d62807651cbc2f0f5c30dd6db15cd8783e8629a6b86d0c6c2dc3096178edd53ad5f00d59174291ba6b2df8f206ca8aef95014978b45d6f80705ce59c95c7ee056bbd26cc2076492918a9f8156f23d37ef16f720da73fa46d8785c2e9065bb74ae4f466ef5c6c7aa1759a89e4244b613faec48508f38c4b060b3274b65a2854c03e234b24d0a84fb78f4f8e2bacfa6b55fb11605cbe62028fdda4e9c5d73cc225e6fbee499ae2281bb8289fd7619247642662b92daa711cdb756cd0f04a9fd2fd077891e017b193986523cc8bb6278c307584a8fc5beba1d58f6f39de0ef1b78dfc24e84a49104d443cc2667613ca203b4df39a69e229abf6b5061e38c825d2702d47ef921b562f20fd64e44f8bf163242e92228a164a2252500db3bfb9a9552f8ea8c82e2291fafc8eacda103d0b60631b3ba78dc7daa9b286b74a302f5812c4c24ebec2d1ef7436730472935dc9c9d122d5e15eada06a4e319de264d4588a5aab1e308be785cdb6af776a564a738e53104d540f181ab029e2f4a4c4b41efbc926228156cb92ff9d470da27a20be0d8bb8a0a11ee0652687b3bfc1eb589d4cef1bc78860572afbb3a09661d1a6707de42d15cdb67869ee2db9a729b5146405e02a59081b6a186d678c236d6f8627e054bfba0a6c5d6300a6a7cd2282226e14ef12e012589aa8214b23e66c215d24ea73cab7828a1c4c42bd12266b19d49dd1310cd9ee4c8cf7a6318fa6d72baf5eccd99bb1ee277401337bdc7a9afa416f5952f9ed44a1ce4032e9d624fcbfbb3a9af916b118c3e282e99eed3714e911bfd1d0aebb79aa00ef01267ffae32d21acffa7ac01114f0bc3272bbd23a7a448149b3cbc02c3a0e4f0d651dd1e77d77fedcb21f03f2ebb04798de7f7dea3123d1be9ba43a0fefc3cb4628ee728431f32f9244e70a6b3e0c6246e1730dd64c4298e625b8aba6073aaa8ca0ec9dd38df4c49c954752949072905974e65de6b2d94cedd5b45dd5e2b6f6b52e4aa13ac0ab963be867832c169dc25ed6d49b6d169a579a49b03d23247a7e49adb4b2fb4c9fa4c83d4ffbcc97471484d5311ca639179cddb724b7f7dfb43c8d09262b81716d03ae700509e3e0d9026d73a530c3f14090357c2def1e8958c0efce1537e99f11fda16678771576590d7141fb924ef514563379cea50939087c63085a1fce8e92207a2e1a0535cd2cfec8d9c0c97216c23a512150b1694e6870fa3127facb3cd871db9adad3b5937212991678aee5292235b61d688c51a4324d3525e32a5d74686fbf42636845e9e5487d2531ae7ee53280cd318452326b16a391876a01be9d7982b0eae07ce4b4d785995c1fb58c53cf412b6cbdc1d8c8ab36a7c5ac19cc621a794ef84bf3e036d12f8942bc7ffcf765a1d6d36d54b5f2a0d7367ba56b4ef4e3cba21260324986cd7c049a5270916b11b64a4cfd918b0433eebcb3067eeb4c42afe6a40864c4364b40d1760e173110d7e4fedf3fc660e87666cf6acd27393df5f2f010e4428c726e7272d0af78045ae0fffc1ca666a5016293c300a010146e29f22354898edaaef28416fa183e8c8d9e6ff7e9ae0a036805bd4074efbf91f18f0763dae23116225dd8959141ce66650fc3e6d14dc3cbab3a948f8e13219f22039df284a523287371f3c2b5f4a6412efdadf783bdce2229aed905ee7d1cc95e8a65a397b670e95340636631e994837fec8bd919e59e8def8a4a0e5ef2897f534f01980a687a4c605e82ed6640bb46d650403124bfd88f068a0ded2d82460a422ae32a2c01f56acb0ea154a7f7a7ac0f3bb0bbb33fe304fb3dfe5d858fc44d148d3e8eaa592083f0000bb4f8398ccd86e23ca023ece10a0f36812dcf18fdd99d9eecfe376f8376bc1f84da3b8e95d664a90d955d8c62d2fa2058139cdffc8263a53087ac71fe210b3bf2fa5c1c73d2bce8abde817a21feca574c1cb95e50e7f83b38d915dc53818fff753c5564dab9cd94fed798411b35b24a02e66129992def0c2dd36bdd18d31bc2472f71ffa6e9d374a5b4d8ba5930117275131e64740e989bbbd82014eafa57d9d29a3d2b695779ec29b10494e2a3548ce48fff60092df712c9ae97fd3bc1874d6f1c5d5045ef3032f4e0ed36a8eba82f5c05d8d40c5332f536e9a7efca0d079ce001d581c0d1468035391f3432869462a01a6018f19b6055526467943fe6ad815ed451318bce29ab10f0c59698822af8a7f82ce40988c90b68d15ba7a0c67d54ee32867c0c680d2d56dc55e7a94ac936e83784f3755762e1ad0cb3d7d0c95d6a0ee32d35278e56012b28100e6e70ccf1ecc9283c104fcacb98b3d8ba35579595e875cb8a59ae3153206d43f56d0cf821eda2e978acf2984f1e55f246c4e593e4b702826208a8fec6717ee4a94d12174e6dc85a804115553602aa365bfbd00515087f6c45e4f9fd7b8864698dbc3b3ef7af8e622386d0f10f905c7497708f79964a6204676ae653b360bf40dd090140fa3480480fec44993116d6d232344a50f0595046182938a54661dbe9158b6d53db26e959a240d2039e75f3bbd1fe69e0f436c8a785bc9a2a56b9bdc13efecc21143dedb941313a29c241c8ace8327da5910bcd73635b073a948dbd8ae78b91cd6ff8a8edecdaf608796dcf9bd85b7890a1b3e48bf4768ec507ed69af64ab4ecc8406e142c051657683b2b6482cb2ab845b5f2aa5b3b616efa8263b7bd70aea0500f6cc8dc52dd3bc047f115815412cec42e1ac3f3b207faf9437be99670ae6b763c63f9d8e31793b0c6dcddc76bceb1d545426028302af8427c2bb1d302c5c568dd8ee3c33385f43d66959c11c309606ce9550257bd80211c10953e55836fb16f6ff4b8d85c9c738eda1b6f31b23d8f488d32147eeac6d50924f16118d53bb75de1d51d274ca8e2dc34961743cd4e90eb7377617a9133f4e6ac7212360f652be0419e918552dae46ced2a8ef12dcc7a9bd5b1cff772c1e1230b64e35b8146d6e3b51f3df1ad475f902ec28ab42fabc6f5538b4c96f7593548a1c8d773ffa58bacdd8818bf342a25182bc668e8265d284dc8aff5e33514ebfe62f45d0d5d8e6f584bdb79053f99ebe1278c0a34ff0a43f0a3616e8ba90a5fb38bd4ceaf5d31c280f404f60dc778727bf5a811b88eb9b33459a338c991ab5433c952784fd8717451d557c45b6e2aa77fb28245c98c175f0128fc889f656feb007088a979acbf6e0792edffd51d73525178daaab0ff691dedbeefdfd3584335de9428fa1f93ba50ec0e2b2e1958e5f05aa60e0dd3cdfc6c2e16c99f431d2e9ebfdc9f38638aec13e3667d101b56fe08e3c835bdb12be38d1cece3b2a52c2d90bdc72da2139e489cabd108ae4c6d458bd334cc2261979bfbf6b131b24ccfed38f7adcc81beafbf3cdeab4dfe9e17a8da74c1b6424e83ca6a04a36dc3057a763601a37a7d9c5f51722753739f3a48a545346e8d0c0d8d578bd19c6ab97e34a4f7bc5681c9e1c8b6342f093a43ae9495f64066e609928590401376401f625ffb7be1ee388c2f0ae26c46fd859386a9b96dfae984007cf2458d8f35a5be2003916e7160a456e65980b9424c51726105a015625a73aa06f00a3c4447b855ce536097f2c649f75db944d60a30825b7f79ff317bed4af87c78c1463658c22be8df460791424b48bc606219ea079474396e8f32cb1020673369192fb69dbb5491ea04d94a722099408690134794e8b39c2e9c8dcb6c0b6277c47c324d389d8ee22e6414b56d845255a99878b3ea8f8412b0e2e86b137b0bb088bc0ec324451ea645d2952667bc64e3db2e40c144091e1086fc702fe0050ce5624e49ba5fa7c0206e7db15fe85588e97d959f465471885fed5c121ec0fa83a3a54fbb20efdc820e44f60d53f65d8807759fabfb4c6c689d16516d91dd820093134ab127131f92585bbe69666c0aa306d02f53f53e40c22dc50ec219374f9288ecbbfd3f800ab14c6444a954971fd39bf2ed43ec6798ae038d364a71a839d2f599122bd87fbb4001b41899e85badf76f90e5378c7868a4865d99f8aa63b0cb87748b2dc5dde8c29f75f060452a663fbc7e008f161dedae45609506d321720f291fd0dcba5c01f4bb69b6708d867c11e875ff03134f2276a858eade3f9aa5dcb6d2a542b6d99b0a87f48fa12a760f94dfe234898db844978c2a9eaa1bf5cb435d78f66155509fee76393cee7f82fd58453b6eba5052ce8459ca96cefeeaa25daf23cc002b79fe2a833993d57491f01f30fc672972424b45c9a3ad26a53ac3c2bc9389178e25b50fc9b1099d837a01ccad75eec87991d06d8e8b77800827b8a664fb6cde5974b6b31c0c2a19ac7766bfbc2b3e86c4992d4889071ae240561801f32ecaf2f8e563898522dc75801e68a89eee2dcd23ddebf00f0b75ed0ae12e27ce7b2d891e081ece220b4e5306e318c38f1fad59fda2c1c21d52a589a2fec12b38a43e5ae1015432a6412492d532632fef204fccd2e1b9aad3ab37d376e78a72bcb0201cad1a1994d9a462b5cc82ce2c150b4af2fca1178881f368a4508406cd5e67089d6c7aa5dc250c04f6a3c313d0639819941c010ef5117de9944a7ed44012cf5b168d52978bf636a1c81f941c36bdcd6d87c801fcac24156c982eb2bec4bfed1973bd2e993986cd3dc46333d6ace5702ef8a01c5a0c0b6eabeb4518595b4326f23606692459a505c911259d9e6c9e22ce2ae3659d0d3ac44638f6f4cf38d32adfc2bbe8eae58495388cc935e698015717697301300b358c3bd5eb33dbdb9ca3be55942778a878c47267899e374c0acc7af71a4e079b35124d3a3617328c3a66bf4d449ad4f8af17ef5cb74facd47dcb183957d236b35a694a540863cdf941093ca54a05cd505f4ed0da4706ad882aa619031ba78e3c1a28a9ea8bfba2f2bb80b5cc7e20f9d9b8e56f4c8d165c4167d5ccc49a8c71e4b89f2d610e61a3bddcc9ee8e9d8d9008c2ba950837e0a37d1234850f29eea4591c211b9c70a30b872556f21772f8940817f9f85f0a37d023b1c9ea41f5cccc8ec704287df522d4a4c4514e7640665c0f1fb50c1d03c42851da0428150a9e72c5973ed4965d36b040eb7b0700913622576c348d805efdec65bc9eb46f66aaa5be032f8b689e70cb6d736cd2c9360c61bc754151456b3cff5cb2b524c1476bec05d9f28ec8f22ebaaf0172f6583c275e88c9f6fc6ec0b3a1e3a1e492bb5b29cb084e19db115f84d44d36cd6e92b1e51921b629dadf6e525f012c35c5d72c3def46ca6ae93cfb2aeb5a9117816fae0e688d58f50c54b220761faa7f1776f382305ec6913cd842fba87576d4a3c8b97ded279fac5f8cebfadd3513f9740b12aa5b1f5a060a4f5d363d71a9f459ff30c4d57e3391f8263d7e2e2acda936f237170f1c9969f13236f46de1f35d8db94faf4a3d60f4800d1fdc6af9fde6e241539b8bd8ebdb63db7be52efc855fd651b6ca31894162ed2aec42e87b9a0ce881c46f2d0a021d61acd66b4068722cbedf8f37ca75019cbdfe0b7bd803fd247b658db813559e56a7b90f9349b6562e9b26a99929c7c62a4e5ab578a81fe4107318ae0827373870cd9f0c5aa8dbfe8e6d63d6922c7a5d0b5ba1a3ddabb138c6e6ea9876bcf4f987439121551c8e7c0665fd4f954ecb448d1fcef2a8e28498019b39c6b81d19bf3cce0ec1e9b59402c1d36bda3de3f015cea099ddee3d25c84b133bba56deb1a6725328cf7a89494050347f84d71e5c0aa7717dbcd9fb12a28d65080e1848fa4d7bd616f6b65759a4d49ab7f1f55dc40c43284963a07c36c65781d03cb920cc1c176591a4f3760d2296602db8189af2c2d30e098716e95926e168765427d3a44b400017a2ad4c664f35d9cd27e8541931b756f2cfa111bd822209edefb495bd14a57d5e3aed1291560e91ec4867f1bab019e91bcfb68488aa23bd4fc5c5a9c81a6ce14aba8bacea4575e2ba77edc96e9f9ebcc46491b23109f50c7be905616e0f082d55a5b90f45c34849207f6c9ada176b7a02c1d7af5097aae69cc5a89d3465493661cfd915af758a7dd0d95150c06be1f7cacf3cc55984acb6754f965518c62d523576a0a390e97702c70bd57ae021eb4eca4ba8a7c6c46d4a53644d769f6f354aed9757e2c524984e47e7bad047338c394f7572515e3532f0920228927c6c1dc89a023796f50bf6b70be6acc43f8b40f6090525e223fa87a33e1f6fbf92478ad528e51ff2f25be6f87323369685d7d80f962c3a7763834045572760d7d7bf8f0a9b45ee8eb7b6fc06960cb8292a5fa57c6484c3afaf8a1741f2d9efea7c94a667af434a3b40981e67506dcf80331c4d27799de40aaea98155813f191c43777d7fe0cfc52e1aa1b7ce8d64d02e1285249a88658c9a4a39973c88b5097427e87743ae64cece7b41fd298f044e821abe1a68c75cb380fd3045d7b49f83179ad6665e2055b8bdacdd4f9a91851e1ed81d7252eea2c9d6a00a9ba359955fd67a243a2ef98dd6226f3767aa9bca6d85184f785edd30b400cb492fd32c56598406923307cfc4e27a898d677b84c4e7fb51ee20bd17d7956b1d6e6089d49b20d4dedf12614f402b51bbb9f21d5fb9bba6a8f6592d909a2777f613d070062499cb642429cc01cb2e3c3568d2cb9d8fbbc5a375922da8509bb20320d4e87248304b09e4e43612a178dacb4d4b4740c1d57fa48af7d1b16a7fca623b0e9abbc941f829a9c332984fe13a253e6ea6f2d1ac27ffdc9b3e540fce2bdb6fe1d5cab2b7409810dfb63b1182551e46a64c0b9a13eeb434a1b9fba9806b591375d4d7ee2e382aeb00548ce67d335de0ed032a84a28ee49d9b429fc179121e9eaa19be70e76680adbcd1c0a86a457cb45b69ab611ccc85d89fc162673fdead42af72643ee195d8a25f9f27367acbf34dd9c27676c6637748f14a811a4c0806603e77fe269cc5528766713a2588619e3eef8ad04facfaed3920b442f236e82166b0d502954d7e3b3626f56960782aeb68a00b7f6210cfd5c19044ce11e1c20ec53dc1d8c266effd38d1ca3da232ea0ecb58a08710c0e6b22983f1b40776ce60b0b07be61bb3b6f6262f8406b276e612cf2d4c6678059ba65f2d8bed9abf3bb6ee58f4de91a032f17ec459b08ba85da1a5915d87bc9f9eb7d266d89539bd55e2999cfdf1b6dfc766ed05d41ef022560dfd2bdc2ff04ad1a0c20d510227cbdcc7b291fe813dadd140c1d9643bc4ea28b75ee230a72bba3738c85f059069fb9490e963b36dcc9d1c7ea447a190015ebd8bf9ab171eb3ea4d859589f8e2dfaf1d04db346e0d1327162d9d33b02269fcf1639a5e2cbe1e5fe108bd8065a3e40692c4287ea23d2aedc189352667357fcd24ac660dd9ab38d348f94c368a6c8616c053a0d53e27d81f9d00a106284222b61de046c46ba83533bdc8b4a379362b88dff228fa7d7dab1d4b3cf0024570194ebd607786538ca00a3d27d29ce6820f6c76aaed59c5a3dfb8a49e909338c026db71fb2ca0d09a1d68da4967f0411310eda139a8cf6b644564db8b6f7c3bc6534eb60d03021c508bc49ce065cf99dcaf00541b7665abf1bd1c0ab1a1260aaf84607535a3fcd9d351096c98a1459bb56fb8e256af66e66d13d17360f2f97a4023894dae7e26d4e059f889d918327daca5a705dab7295376dea06a012e38af563ef00a24ec863270bf136fdfbba03719f4de0ea5237d5ea8d32ef3d237ef3b8f4ffb7b1cf8054eec1fe8125d98244ce42f0beff389019a3f6315b817f90cea3247a266df07c109ba520f8622e03709ff89bef3efdb8e96a44cb48fd405117cb93426732c62f3e5996fd1c2722dee0793e46ca5dcc6ba2271b032c4b5e8abe2b51064544b4e8527622edbafc017d8092c60a6884cbc12a6c604ec4625b45ad8cc1f76dc75dbbbd75b543d716eae8a961524d87d76ac1ac9eaa30f3c3a5550369fb3b216f21021c85c62d6c491a9df27bd40437fc41e3f695c649fcde2998bc339853e4d7db264256001c672947bee547957a38df7c89c4edc8e5a7f11c603d6e65a1d7ec0ec15399352d1fd1b06e2b1ffeac0028684825bc9056f2d713b61acc70f8f220cfd53b5a64217e4fb82cea0f412d7faddba5bdd5592b432d99e8ac0f00803c10153cf1f9c16ab9996c32208518656547bfc37e43fce4a0da4ba0cc759ca8ba2189482955578a0e193e74f0b1f3c92e91a666558c1c0271f7a0774e6096bf72f7f8fcaa0b97acff40e9ed30feb75330e583660829634a6c6e8dff4a72323273ee66c523dfb6b628e97d711e5a43580aeedd21431a58479afa2af1a8d77967dd6a44d0e4308de0a596933cd7a8bd5acbe08c4aecc4b40ce56f0a4f10143f99d1fbf8fe2cc850780e51cb47de34fcf6a2c9feeb3a038f27bd8afd771b04b5f7b892fb6c13684466450f6d68b2a76b5141c8f3f93242fad4952f373750017a2b193fa8c0c60960177a1e39d527f6c1fd14d94364ed0398006fbc72b3435f6a67f3370c3f9660d9a406bc5ab900feee43000741bd2f616387c960c3c0ea4977cebeca4e38a0b7bdc00aa4e72745ab9719a2095f218f246f9520977ed4f573cf29eb5d6b3f998e26cca3b4e6b96bfae2eebd13fffbb17e025f8bf17fa8ca34914fea0076cd636a9143edeb1efa479a234bc9e644cea4d3e7cb674e6e831e0cb8a97383b5e1da1712c5383baafbd9830417a883f5eed4489a5c082b979438a40f96a1f23fcdf707cd9d16fe1d05793da0ca84f3b5138071b715177c68f40da594c1e6e4a140e91ddae151610d2272adbc07cc37df2bcdd4b0d26b7004b3a8a5e8c1b882cf65f7dbae313113aee718d91951f2bd111061be50f6926be55300ac625dba675dbf1a8454533e47ced13b021900918d23f456bca1153e09e51332e2861116b4806bc2533b58979ff1ebbd0d2ec2276fc76f9fa259f920ab6d3be3af8cd4372b9f8588304cf3e4786a6c23b9dc0f59ae0ed4a22d8c27649154c7b1aef1a0100d94099dbca3f885592a7e05cfe376a53c56cc168259aee66fb1e4639646c8905a433f2021d018a42c6f66ce0fa2ae38ae2fd4ea597a91916c78198429faf069d624f13dc1efd67ffae9397b7765be29cc231fed1302b619e74cf1c4745d78af1005ed992f79a8b3f9e6bb04d5ecfface00f004c4fefb6a0a220aca0bef67c01f2341a659db0bfb468285ec31a624aad473d87fefbe1b94a01ae83f7eef77c432d49252affabc74cc8cfcdb44de3bd010e7005cd8427ab4e5680ecfe08bbb7d379cd71824fe2cb2854484eb3fa10706f7e3ff6768641605e6ce4a3ef6d150b4243f34887547f811e506535b34125cc1f323a16583513220c0c0e1c389b185788133074e476aa159b646689503ed1035695180ab0941a741731dbbd79170b5afa2d20cc4e8020c07e9f590f913be9066c5da497c0bd9fd87fa5be93d5e535198b9ed726c98bc6a8a17e99df46f7dd0bf4b67fa14ecd168b0808cde5fe7eb01bf7f10cd56dc5d4179f4f3f70b6e3def18b9e76f656c25650cf76ed9cba8ec5122bc523bb8a6366e1bb32673d7448aa7b2555b90afad7be1bf25c88839e180a1fffcf0c348e5793960897c1fdf5ef5bb3a4864036c56c8aa29c274511b16abf075a5a5bd1d3a0d09ab47d71c912583f4fd1d25a922826094a891081c1b13bc07ca440ba34b5eba869aefc76e247e8b15ab4d5425506bf28f68d1442c9eda40df889493db54ffa853e9988593ca0dbadad5d5055a9591737b9254e415a7c1b3c7ba2f6013e05387075ff5c75753454618469201c4f5557fb35435a82b8c6be6efbe9604072c942a6a0489d7115992ea6c87ac97199efa66e22bb9b3fc8c2841671bf6eb7f7905d4bdacc83db9960ba84dc9c69adc1835ecdd9d8210b66d672bf861e8d36734574762d7a4e24f6efb0eb323084b3802997732287a05a3d982a5872e34ac093a4b1735b690733493f27774d2da27555a3abf3e5666b3df22acf0a79cdb1335eb243b643916cf1b85030905f222631147ded881a2462e8b88eb06ce0c524d10bbbe185362b6c4d8be1a1cebd4a23ab4dc01e34adcb4dba3bcc788502330a79d03892e5396778aa648f3282d1110906ce9fe128938531412b5a34c341322ebad0c544ae6ad82567346a4edc9a81f73605650330b54b8bcfb9bc341e0a3c4567779e2fbaaa72c98ca8fb94ac905f922c13ed24dbf258ada533d8b4cd460fe4cb3dd23bdb9f008d02cc5affef1cc489f0ca5d6420966d197e0dbb77e44f1bf39a608ae96ce2384062b5a1c134508030d423289da377beef8e89cfbb0f51d0cff1b1d7d46663133c1fd54fc31e14cdef40728d8befd7ee55b47c6468948d15bba4f500be718ea8aef932960276f70dec2c95c8220ef58a5b0e8cabc3076144391219a09f772f925882bdbc776a588c053845cba0ad9de4be09a7df259f35b815c5e4bc9dca03eea7425fc835eb543501184ee9a0ff5b48e3661e05e771c6ddc6137c408d18f78b8b3c1ef3fed8ab4b20459ba2cbf3bd0880842b95a56cd822bd49689b290c85e4442c4f414c2b1fc9269ae3eda29beca1a815f7e1d5dea7dc60fcb13260065fa89e49d5a8d34745907a955d8e0dd5c49b19f6f94dd9a2212f2e187ec22c2c21690848b07e783087275e8a7576e2391bb88fe207517487b04c1b87ef82345b6a68b48785f9f7d2e2c0881327f782a8617503f071a9f894a9899ddce2061c751dfe95e612a4e79b8ad55e0606261cc6f39742b0110a2b078b266b7e234acadb7f326650e6953a7881a9cbc4845857add78f42b8a6f2fdcb4d66836dfe21cb4ca8d6973b3d52466acdc251414230fdb97444f002e8cb3252029edf70257f77a401e88f79d0b97577a2fbf5a139cdb507459d01d04df8b31dfb82f958398c5206216a87acced637a0aeedd07d99d64ec1ba56df04c6f01cd5b31b848ce0b940f1ab26ca74ea431c59f284e6d7cf63d80ea44b007b41f7a2a2eb03a5b9a75f69d252094b96279ded19310e34fa872896c6dd6722f97f5a1d5619367f897e600dfc34c9013839846dea83e3a5c5479c0670bed08dc5691c502a2f72f1afaf1d0353fe46304bfc89fdb52186b49d7a87651703788a62d0459f380a25db8d86498ed4b66e3660f10b3c075bbf21fe9f771163fc88c03d65d25276568248d8f82ef3541b8c38971a23e00e2de5f08bc2f33737f6aa02d2dc612d265c2e7bf79685f387d70b71774331331237ce7bb816510363f45e15cb7e76fae1c537820d83223e5b560fc1f0483a97f9b291ea4c10f75583f827c40fbdc6965b6ada64e1ba75f25d52e7948e644f075eb882ea143f450c40a757748769ea30b2fac80fb6140ee8cbe1aaba1212663936deb56277f4790112e7b2ec0ca87d4dd909c8b730053d9230688f533daab85d1b1ead84652d11d903a76861fc5c37a1a4cba2e67e45b7d8813c87328ee4d2cbb3711bfc266d24db4a803b510f8554827923bc6b814148f7fb450d7e8b1ada9696ad151d74af9dcbf0a33235e4380747694023b78351d54077922804e44eaec3678700d458f4434055b249efb7de26d65de8a776d20bbae5f7129373864a9ee9bfcb07b24fcfdca17021ed47b22afb10904a914f5aef056f70ffbdcf57733664aabd113d8e2afdf66148b48d74d7c6cd81d5c2bfc08ae30076262d822b8d4e49c6faadf7c92663e31ae78efded8dca803369b38d69b11c992eaabc516e8b98e8b27dae7f187c3a247c18782a1cb387c0e2b74ec45be662d215ef82f49824e9968b5f05647db36e512d2ca54114b524fca196565a09be149426520967bb9c1f563504108c4010dee6d45129b27ec7389b39043c230d6df48f8c510cb5db9fedbf4a7809b96ccd5a011ab47efe47ed8698e1d99a524dd9f3d399f08c547f8797c3b18b24dcac9ae8d157a16e274cf09a537f6cd2f2a85e1990cfc16322800abcb8e3ab3db70d248aac7a486e7f6e4efc35d1f254cd555001c4d59c371515f53a1e257b6dc344b2ec082552a5f3ac359e2f7f282cf7a8ad2ad67d9630c093d2109e3b65220e068e7f2b88faeea26b8d1ac3babcde69b9ec10eadc695812764d304c82566ad8847bd17b2111422db53503eb4d5292d055e028b0ea6f33c31fe9a05c95c61895f2d957f18bc1d89fe628d0694a1dca0162f5172ef2f8f582d588c81d3e7e161bf54e9003a891efa8f82b831f43836bf95fe03c046af5592664dd4636db8f9851c6d940078b7c7e69ac50c2c80f83174301ee0786996f82c3460ae80045a809e4f2b36b1a45ab51f33c0df92a9050b9432ae5fceef857ac02994fa00961942225833336a9c5c7ab04905c4052d4fdc973684cc3a6ddf96f18151cf88e3a173cd803969b11a7dd1592da950b51eebf0c3dba52d446afb0e9011097372c8e5cd69f7b269cca3890277c7dd8a0d4937e598bec738873e72959b04be2ed689d999eea0e8e01e9afd6069cf59d01d58fc865f279dafcef3437be5b93686b95ab8aefc1a25b12d6ad6ae0c686f59fa1b90c2f2da14a29a4aaa87f034d48ae0a2874c69e4b8de494c4a199a2aa50d55ae7cb17e32bd948a0c8fca19bc9675ba23831ff7dcae6a80dc58a45020ec798635b6a176d285d9a8c44b4fe8df504fedb4a4a72d26444fa58920a994c3f132d313b423b5bbd073ae2d33c81c3b6929c79163d2f28236e81b8dd6030e237673e3df0197d950a26fe706b4f14c919a1f7f29f71a60a19efbf5da61d1ee3595ba0658c55f8a9d46e10c412974142a96c62462c6eeab447f52d0a619a6db40a2a2ddaf23a541e02cd959298fb1c220530ac1950d4dfe9be9a50d4980a91fa0f716eabd0839b7de4cc6852e1a6c7c98656fe7d8e56999b949018a1fe72b2a9964a830a3ecf34c20598a5f439835eca5199a6d583ae0f5929fc2324c2c5c848f1bb73147beb722163f427b9b8a8907e5b952e1f6e3a8dc3da9bc4b106bdae22176e6286ac0fd00272a4dcfd1a3f95f0b12d2ab370d30e8c5e3dce8884a17f7d65c58237dc8a70acdce798392345b27a039c5a70c4d4c6c8d564627acf37c167a2f896c183e0f20ccb44370a2e912c76deb63e05472e1cd52226ad7a6b6f12bab877d0eec98ec4bcb926f3f8d02971871eff689518f10677a6df7e985646b3113779fe61bfed2eca90c84173c685955025d9dcbac294608a1a2b0b02f9d89b97590428717c4b60dc7f29183febcf17f21027b8dfc5a8c9083772e7667cdad819cf30c490546a2d147d0793ea17515db6732cc5415279112736388e81ac42ff02aa066229add8d78672f2d0d1be80eef7605be9a7c5b99aac9b66dda639302a779cdd8c2e42d9f2a0ff59cfd468a38bddf4c21746313a4dc748e1bbf90b88cbcdc55dd2db1160390149261038a5e907a6a8ff3520f8f17f53b486e6f5549897fa418f9712cda83d556aedccc295ca25c2b75ef30ff2eaba5b93f9e63722c515d8ba5335e9eec88af6d799362dd400fad30c0f205c6dadce03a69cf916a1be1e00263d91c97c72c9f6de1ed8081c8d93e903faceb6f77e9fe9dde8230ee0ab32ca4f4dc405b60bc383cc42f586cc4177052827e119e15876b9cbbb789626f537d6b814a86609ca57a5ad45f2072938d640d2d6707102bc23caa2976bb75f887b2f3663cbbfdc7b6f785d83ed5c835de32e39df7b1350d96c5f2b2a790ebbb310b802f9fd47b0ddb4c5a2716787092360730e9b1729d6cef924660a48a61e57df10ba1dbac8b2fd85894782e52d1da6070bf67a89524454bef1f24e9164bf687c9dcac6b7760099a78dd247f065500ccdbb24272d2a9ff52be941d4d40d9a30d7fdcd9624eed96ea7d9e7a163b1c48e4d683328450f93eda10b8fc54f8c0a2aad2f10184656273b56945ea8cbcf3040a79265e6405d01477ab3afa64122474f3ee2999c03a6aeca1bf048d744c387c13f909bc348c899badce6249625573e981976214e17d32d829996e7c8e6b0d0f4c8d771b72af791923f17fa3283c66d78a37e281c2a77bc3ddd6718633acf933f125c2fda6ebe122916b841a8ce94d85f7be70a557d0748b40d13bee10bde05cdb46c008e157a3605ebcc741193015aaf096d0387a5b0ec9d7643c7a2c95caad2cfa24bddde072c6d7f1dc825e4a5c3332a58d87b04216f8cfe2a28b80bdc115b54548acf075b3c31f5a9589c158bb6653993830a10f67658d88182ecd5aea551fd9c6c5b6f154e46370daa438a02a3eb35af80bb1b3916a963b96229c08c383b200c33e248b92b4dc47c2fbc0f022a2c8410cd0d6e4318c6da1a2a98ccb2770f9cfdea32246e71c2c5ae096fe681408ab0405c9d7b448622994f4c777646f8dd7944a1268e5fe5009df196e4afc190fab4e1883f5aa7d3b4e034346c5228da7f6eccb1e9e9b18142ad2fb6936595aa71b4db3afbd964bb214d9a03ca30c96c31f207b6a4c03db00a7687f6a9857ca56fca2c7e50be326d1a82273f3e45194cb88cec67dc99e3454771a718411c879e343a2f59df343efd23563721b0b45f57a21df0a3ae33d893d7bea6c024d893afb90f56a274de03a7b5cfe669a20a5a757b26356ef910f835539193dd3d0afcc781e6679398624a99611739110bc7e61a820481c7a5733608b3fafce39a101fe17cdc346b22527de5bd0f29dfe92d2ac4dab2f8f4df39390eb06394a24594f9f2d9c0880655971b194aaf67298c04b8155d54cb891fa5efacd49a08cd220acda80a9450fa9bf4533ac04129d327c04ccf95492826446285e8b395178f53056f7d244283b5a218164f1d36639cc2c375db164484e542cdcb5bbff1e93575ac9af5a31215d5e36569cfe937b06b484d47b6d51e978f87cfbb6d31de4f283be87e60927a8f695a74640ecdd3373a3ed5edcd36597ac5f598f121595dcd1a9f96e98af2e6e95a67d70f9465a5ec0a2e7bc486610935922a5b2923bb61b559a7c26d89394d3aea2a0a886054d26e43f9a87c27aad89c3f0e3a695853e4675949ab9809181ce3de0a478888cbd03b5592fd25a4ad23c4e20118641b85884c3fda2da23f64558f545a4b50cdc3dbbf7f83bc533f703c4ca75333e038602ab8af00df7da01d7492c4226c14da262be930be901a1a400d708b3658f146360f8b34146b7621379938dba0c776049bbd06a3f7e0089bcbf097d81ca94c5ee43199df8037b589489281114a1cdb0e222ec0a702b89f9872e639e6715b5aeb2e4240d9070421edf7a8ab3e336be8c463b02ce9f2b8a25a95fd1f17b1a916431ae1e6e92b7511c2b3357fd6efc7d633dd74eae91a0e57bd3217b05f7409c1999c134f51a70276cf1da34fdcddeb3a4fa2a767769bbe2c71c297a6b0704e664efc14890427912991922f47a8dfc581c4c29e7d3fba3ec0a4014eb7c5686e351d261060a8c76bd9d2171a32388fa7c60b0faa04e67fca6d0a5aaa615df7166eeca7070cd59011a0dc503b4f623e41b9ca57b89f01aaf7278589b6e461e4f482296d53516b2b23393fc96c0599ec3928d9f3189f214b5daf85d162c964cbf6baa94764852ee81910674f1262b06b0d1041ea50cf59f4ba7b6cb5e9d40816e43ab51e14af18310ba65f67d5640e8f2bc8066d7f0c367fbdd1fa56416b56ed7ba9453e1ba10869033ad50cd1f8a457276158c72e772ba2723e1b1a7969a0747c57aa730eef26322c4cc6c4377cfeeaca47164426b4012e64727a6ebc2806e31f012c513baf688eb08e965d8a97104c3fb71565178c483703627a65f72eee30249c0d01e85abdbb33db515b83d772559f6cb38fb4b14602e0a2c82dab4ab0be772cfe40dc6c1648154c180dc512fe7a936638ccc308f3ddd15d489ec30f75baafc5dd889dc49616ee91d0067f5e92fa0075ffb84bf68ff7908c9d23ec68d73a29762b0b5af5e000e4b437b1874ad149d92d5d582e19d15dcbcbf12b33ebba4bd4fad2241e68d0ebfe59ce322818a461acdda1409c489f4bd496c418f23b386deda7d2fd95cd2c39a261ee30f8a24bb0a591b93589444310383128f048b46c0df7444bbc1f08d4d893a63f3d5cb98e1feb1251dc0271a7c0760a496af2481f5dd52eab1f94832c38938f3013791d6a8b896ae69ee287d6fd532896632b7bdd41f1a7e28061d7970abc91d0c79dbe49fb90d029929fce5adb6a43bcff8b8c6609306b1993102361e502272fa559e93f13e7f614467f08a263c46d7e18e9c783a5df74e7e830360e40cc4f0fd6fb29830249cdad506d7480b9a9a2dbacffcd56de85ac003ac9db14189fda874f96290c8e95bdca41bc962500bfbd676db01755d351e491a1ba531f89a2b8fcd553af1f49f19855742572c3e6d2407d7ef1999f599eb9127fa1d5bfabb2bd5f8ee9f70a98bc8e7b7b8bc4e44798fec8b8d35cd75888d5d87d3d38b6ed8c6ed872293143e93625f654b34c72b712026fb4eabbbf82e58bec600a2826577372e9551b2d59fec40b45e097636e1f0722441fc1ae52a78efe86828a12d3160d3b7485e4f8b33fc022dc53f3d3a93afb3f29fba952d4368363182622480b1b0630e7aa46e363d1015d028859e5f744f673f99be471afd13bda70bf9cffb89bec8dd4021b105b73037aa00ae35c4ada7d00c4d088719ecec9d78113ff2b0545038de082ca5188c2efaab5813fcdab0c1d95703b206d86a7cf5db715ef3dbc6b573d5ff1e6d864a599711cd37dca24ba05f738444fedfebcc8092b3202a38960373e435776c51e98ec04d858da95381c5bfa7ebc03e4f39450f07d6873f3342e5b650768d3044a145337e2548beb2c6f019f87cd2883c76983fb540830b7022e9f85780ec34716f099c","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"79d09fd53fc05735a2c62c20cc82e383"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
